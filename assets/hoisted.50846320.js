import"./FogBackground2.astro_astro_type_script_index_0_lang.db0e11cb.js";class C{x;y;radius;context;color;constructor(t,s,e,h,o){this.x=t,this.y=s,this.radius=e,this.color=h,this.context=o}render(){this.context.beginPath(),this.context.arc(this.x,this.y,this.radius,0,2*Math.PI),this.context.fillStyle=this.color,this.context.fill(),this.context.closePath()}}class G{x;y;width;height;color;text;context;constructor(t,s,e,h,o,a,d){this.x=t,this.y=s,this.width=e,this.height=h,this.color=o,this.text=a,this.context=d}render(){this.context.fillStyle=this.color;let t=this.x+this.width,s=this.y+this.height,e=5;this.context.beginPath(),this.context.strokeStyle="green",this.context.lineWidth="4",this.context.moveTo(this.x+e,this.y),this.context.lineTo(t-e,this.y),this.context.quadraticCurveTo(t,this.y,t,this.y+e),this.context.lineTo(t,this.y+this.height-e),this.context.quadraticCurveTo(t,s,t-e,s),this.context.lineTo(this.x+e,s),this.context.quadraticCurveTo(this.x,s,this.x,s-e),this.context.lineTo(this.x,this.y+e),this.context.quadraticCurveTo(this.x,this.y,this.x+e,this.y),this.context.closePath(),this.context.fill(),this.context.fillStyle="black",this.context.textAlign="center",this.context.textBaseline="middle",this.context.font="bold 14px sans-serif",this.context.fillText(this.text,this.x+this.height/2,this.y+this.height/2)}}class X extends C{vx=0;vy=0;vx_max=.9;vy_max=.9;acceleration_x=.01;constructor(t,s,e,h,o){super(t,s,e,h,o),this.vx=0,this.vy=this.vy_max}move(){this.vy<this.vy_max&&(this.vy+=this.acceleration_x),this.vx*=.9,this.y+=this.vy,this.x+=this.vx}render(){this.move(),super.render()}checkCollision(t){const s=this.x-t.x,e=this.y-t.y,h=Math.sqrt(s*s+e*e);h<=this.radius+t.radius&&this.bounceOff(t,h)}bounceOff(t,s){this.color="#"+(Math.random()*16777215<<0).toString(16);let e=this.closestpointonline(this.x,this.y,this.x+this.vx,this.y+this.vy,t.x,t.y),h=Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2);const o=1,a=100;let d=Math.sqrt(Math.pow(this.radius+t.radius,2)-h),y=Math.sqrt(Math.pow(this.vx,2)+Math.pow(this.vy,2)),v=e.x-d*(this.vx/y),m=e.y-d*(this.vy/y),u=Math.sqrt(Math.pow(t.x-v,2)+Math.pow(t.y-m,2)),f=(t.x-v)/u,w=(t.y-m)/u,b=2*(this.vx*f+this.vy*w)/(o+a),L=this.vx-b*o*f-b*a*f,j=this.vy-b*o*w-b*a*w;const P=(D,H,N)=>Math.min(Math.max(D,H),N);this.vx=P(L*1.1+.2,-.5,.5),this.vy=P(j,-.4,this.vx_max);let W=(this.x+t.x)/2,z=(this.y+t.y)/2;this.x=W+this.radius*(this.x-t.x*1)/(u/2),this.y=z+this.radius*(this.y-t.y*1)/(u/2)}closestpointonline(t,s,e,h,o,a){let d=h-s,y=t-e,v=(h-s)*t+(t-e)*s,m=-y*o+d*a,u=d*d- -y*y*1,f=0,w=0;return u!=0?(f=(d*v-y*m)/u,w=(d*m- -y*v)/u):(f=o,w=a),{x:f,y:w}}}const I=2,$=3.25,x=30,r=33,J=r,K=document.getElementById("startbutton"),g=document.getElementById("rowsselect"),O=document.getElementById("riskselect"),R=document.getElementById("score"),k=[255,0,63],q=[255,192,0],F={low:{8:[5.6,2.1,1.1,1,.5],9:[5.6,2,1.6,1,.7],10:[8.9,3,1.4,1.1,1,.5],11:[8.4,3,1.9,1.3,1,.7],12:[10,3,1.6,1.4,1.1,1,.5],13:[8.1,4,3,1.9,1.2,.9,.7],14:[7.1,4,1.9,1.4,1.3,1.1,1,.5],15:[15,8,3,2,1.5,1.1,1,.7],16:[16,9,2,1.4,1.4,1.2,1.1,1,.5]},medium:{8:[13,3,1.3,.7,.4],9:[18,4,1.7,.9,.5],10:[22,5,2,1.4,.6,.4],11:[22,6,3,1.8,.7,.5],12:[33,11,4,2,1.1,.6,.3],13:[43,13,6,3,1.3,.7,.4],14:[58,15,7,4,1.9,1,.5,.2],15:[88,18,11,5,3,1.3,.5,.3],16:[110,41,10,5,3,1.5,1,.5,.3]},high:{8:[29,4,1.5,.3,.2],9:[43,7,2,.6,.2],10:[76,10,3,.9,.3,.2],11:[120,14,5.2,1.4,.4,.2],12:[170,24,8.1,2,.7,.2,.2],13:[260,37,11,4,1,.2,.2],14:[420,56,18,5,1.9,.3,.2,.2],15:[620,83,27,8,3,.5,.2,.2],16:[1e3,130,26,9,4,2,.2,.2,.2]}};let n=g[g.selectedIndex].value;n=parseInt(g.value);const c=document.getElementById("gamecanvas");let l={width:r*(n+1.5),height:r*(n+1.5)};c.width=l.width;c.height=l.height;const T=c.getContext("2d");function E(){let i={width:window.innerWidth,height:l.height/l.width*window.innerWidth};c.style.aspectRatio=(l.width/l.height).toString(),window.innerHeight>i.height?(c.style.width="100%",c.style.height="initial",c.style.top=`calc(50% - ${i.height+"px"}/2)`):(c.style.height="100%",c.style.width="initial",c.style.top="initial")}window.onresize=E;E();K.addEventListener("click",Q);g.addEventListener("change",()=>{n=parseInt(g.value),l={width:r*(n+1.5),height:r*(n+1.5)},c.width=l.width,c.height=l.height,E(),A(),S()});O.addEventListener("change",()=>{n=parseInt(g.value),l={width:r*(n+1.5),height:r*(n+1.5)},c.width=l.width,c.height=l.height,E(),A(),S()});function Q(){let i=l.width/2;i+=Math.random()*40-20,p.push(new X(i,-10,6.5,"#ea033e",T))}let p=[],_={},B=[],M=n*r+r*.4;function A(){p=[],_={},B=[];for(let i=0;i<n;++i){let t=i+I,s=l.width/2-x/2*t,e=J+(t-I)*r;_[e]=[];for(let h=0;h<=t;++h){let o=s+h*x;_[e].push(new C(o,e,$,"#ffffff",T))}}M=n*r+r*.4;for(let i=0;i<n+I-1;++i){let s=l.width/2-x/2*n-x/2+i*x,e;i>n/2?e=n/2-(n/2-i)*-1:e=i;let h=e*1/(n/2),o=1-h,a=[];a[0]=Math.round(k[0]*o+q[0]*h),a[1]=Math.round(k[1]*o+q[1]*h),a[2]=Math.round(k[2]*o+q[2]*h),B.push(new G(s,M,x*.9,x*.9,"rgb("+a.join(",")+")",F[O.value][n][e],T))}}function U(){Object.values(_).forEach(i=>i.forEach(t=>t.render()))}let V=l.width/2-x/2*n-x/2;function Y(){p.forEach(i=>{for(const[t,s]of Object.entries(_).toSorted().reverse())if(i.y-27.5<t&&i.y+27.5>t)for(let e of s)i.checkCollision(e);i.y>=M&&console.log("out of bounds"),i.render()}),p=p.filter(i=>{let t=i.y<M&&i.x<l.width+15&&i.y>-15&&i.x>-15;if(i.y>=M){let s=parseInt(i.x/x-V/x);s>n/2&&(s=n/2-(n/2-s)*-1);let e=n/2-s;new Audio("/hitmarker_"+e+".mp3").play();let h=parseFloat(R.innerText),o=F[O.value][n][s]*1;isNaN(h)&&(h=1),R.innerText=(h*o).toPrecision(5),console.log("hit multiplier",o,s,e,h*o)}return t})}function Z(){B.forEach(i=>i.render())}function S(){T.clearRect(0,0,c.width,c.height),U(),Y(),Z(),window.requestAnimationFrame(S)}A();S();
